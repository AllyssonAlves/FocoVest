{"version":3,"file":"advancedSecurity.js","sourceRoot":"","sources":["../../src/middleware/advancedSecurity.ts"],"names":[],"mappings":"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"}