import{a as f}from"./rolldown-runtime-Dq6TatWD.js";import{A as D,Dt as d,F as j,H as E,K as M,Pt as U,Tt as L,m as $,o as I,p as T,s as X,u as C,w as G}from"./react-vendor-BpwrftXY.js";import{n}from"./vendor-DgHb_Dai.js";import{t as F}from"./index-Daf2CfgW.js";var m=f(U()),g="http://localhost:5000/api",Q=class{getAuthHeaders(){return{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("focovest_token")}`}}async getGlobalRanking(s=10){try{console.log("🏆 RankingService: Buscando ranking global...");const t=await fetch(`${g}/rankings?limit=${s}`,{method:"GET",headers:this.getAuthHeaders()});if(!t.ok){const c=await t.json();throw new Error(c.message||"Erro ao buscar ranking")}const r=await t.json();return console.log("✅ RankingService: Ranking global carregado"),r.data}catch(t){return console.error("❌ RankingService: Erro ao buscar ranking global:",t),this.getMockGlobalRanking()}}async getUniversityRanking(s,t=10){try{console.log(`🏆 RankingService: Buscando ranking da ${s}...`);const r=await fetch(`${g}/rankings/${s}?limit=${t}`,{method:"GET",headers:this.getAuthHeaders()});if(!r.ok){const x=await r.json();throw new Error(x.message||"Erro ao buscar ranking da universidade")}const c=await r.json();return console.log(`✅ RankingService: Ranking da ${s} carregado`),c.data}catch(r){return console.error(`❌ RankingService: Erro ao buscar ranking da ${s}:`,r),this.getMockUniversityRanking(s)}}async getUserRanking(){try{console.log("📊 RankingService: Buscando posição do usuário...");const s=await fetch(`${g}/rankings/user/position`,{method:"GET",headers:this.getAuthHeaders()});if(!s.ok){const r=await s.json();throw new Error(r.message||"Erro ao buscar posição do usuário")}const t=await s.json();return console.log("✅ RankingService: Posição do usuário carregada"),t.data}catch(s){return console.error("❌ RankingService: Erro ao buscar posição do usuário:",s),this.getMockUserRanking()}}getMockGlobalRanking(){return[{_id:"1",name:"João Silva",university:"UFC",statistics:{totalSimulations:45,averageScore:92.5,correctAnswers:850,totalQuestions:920},level:8,experience:1200,position:1},{_id:"2",name:"Maria Santos",university:"UECE",statistics:{totalSimulations:38,averageScore:89.2,correctAnswers:720,totalQuestions:810},level:7,experience:980,position:2},{_id:"3",name:"Carlos Oliveira",university:"UVA",statistics:{totalSimulations:42,averageScore:87.8,correctAnswers:680,totalQuestions:775},level:6,experience:850,position:3}]}getMockUniversityRanking(s){return this.getMockGlobalRanking().filter(t=>t.university===s).map((t,r)=>({...t,position:r+1}))}getMockUserRanking(){return{globalPosition:Math.floor(Math.random()*100)+1,universityPosition:Math.floor(Math.random()*20)+1,totalUsers:1247,universityUsers:156}}},v=new Q,e=f(L());function V(){const{user:s,isLoading:t}=F(),[r,c]=(0,m.useState)(null),[x,N]=(0,m.useState)([]),[a,b]=(0,m.useState)(null),[w,h]=(0,m.useState)(!0);(0,m.useEffect)(()=>{s&&k()},[s]);const k=async()=>{h(!0);try{const[i,l]=await Promise.all([v.getUserRanking(),v.getGlobalRanking(5)]);if(c(i),N(l),s?.statistics){const o=s.statistics,P=s.level||1,_=s.experience||0,u=P*200,y=_%u,A=u-y;b({totalSimulations:o.totalSimulations||0,totalQuestions:o.totalQuestions||0,correctAnswers:o.correctAnswers||0,averageScore:o.averageScore||0,timeSpent:Math.round((o.timeSpent||0)/60),streakDays:o.streakDays||0,nextLevelXP:A,currentLevelXP:y,maxLevelXP:u})}}catch(i){console.error("Erro ao carregar dados da dashboard:",i)}finally{h(!1)}},p=i=>{if(i<60)return`${i}min`;const l=Math.floor(i/60),o=i%60;return`${l}h ${o}min`};if(t||w)return(0,e.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,e.jsxs)("div",{className:"animate-pulse",children:[(0,e.jsx)("div",{className:"h-8 bg-gray-300 rounded w-64 mb-6"}),(0,e.jsx)("div",{className:"grid md:grid-cols-3 gap-6",children:[1,2,3].map(i=>(0,e.jsxs)("div",{className:"card",children:[(0,e.jsx)("div",{className:"h-6 bg-gray-300 rounded w-48 mb-4"}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)("div",{className:"h-4 bg-gray-200 rounded w-32"}),(0,e.jsx)("div",{className:"h-4 bg-gray-200 rounded w-24"})]})]},i))})]})});if(!s)return(0,e.jsxs)("div",{className:"container mx-auto px-4 py-8 text-center",children:[(0,e.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Acesso Negado"}),(0,e.jsx)("p",{className:"text-gray-600 mb-6",children:"Faça login para acessar sua dashboard."}),(0,e.jsx)(d,{to:"/login",className:"btn-primary",children:"Fazer Login"})]});const S=a&&a.maxLevelXP?(a?.currentLevelXP||0)/a.maxLevelXP*100:0,R=a?.totalQuestions&&a.totalQuestions>0?(a?.correctAnswers||0)/a.totalQuestions*100:0;return(0,e.jsxs)("div",{className:"container mx-auto px-4 py-8 space-y-8",children:[(0,e.jsxs)(n.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center md:text-left",children:[(0,e.jsxs)("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:["Olá, ",s.name.split(" ")[0],"! 👋"]}),(0,e.jsx)("p",{className:"text-gray-600",children:"Bem-vindo de volta à sua jornada de estudos"})]}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,e.jsx)(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"card bg-gradient-to-br from-primary-500 to-primary-600 text-white",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-primary-100 text-sm font-medium",children:"Simulados"}),(0,e.jsx)("p",{className:"text-3xl font-bold",children:a?.totalSimulations||0}),(0,e.jsx)("p",{className:"text-primary-200 text-sm mt-1",children:"Realizados"})]}),(0,e.jsx)(M,{className:"w-12 h-12 text-primary-200"})]})}),(0,e.jsx)(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"card bg-gradient-to-br from-green-500 to-green-600 text-white",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-green-100 text-sm font-medium",children:"Precisão"}),(0,e.jsxs)("p",{className:"text-3xl font-bold",children:[R.toFixed(1),"%"]}),(0,e.jsxs)("p",{className:"text-green-200 text-sm mt-1",children:[a?.correctAnswers||0,"/",a?.totalQuestions||0," acertos"]})]}),(0,e.jsx)(j,{className:"w-12 h-12 text-green-200"})]})}),(0,e.jsx)(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"card bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-orange-100 text-sm font-medium",children:"Tempo Estudado"}),(0,e.jsx)("p",{className:"text-3xl font-bold",children:p(a?.timeSpent||0)}),(0,e.jsx)("p",{className:"text-orange-200 text-sm mt-1",children:"Total"})]}),(0,e.jsx)(D,{className:"w-12 h-12 text-orange-200"})]})}),(0,e.jsx)(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"card bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-purple-100 text-sm font-medium",children:"Sequência"}),(0,e.jsx)("p",{className:"text-3xl font-bold",children:a?.streakDays||0}),(0,e.jsx)("p",{className:"text-purple-200 text-sm mt-1",children:"Dias seguidos"})]}),(0,e.jsx)(G,{className:"w-12 h-12 text-purple-200"})]})})]}),(0,e.jsxs)(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"card",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,e.jsxs)("h2",{className:"text-xl font-semibold flex items-center",children:[(0,e.jsx)(C,{className:"w-6 h-6 mr-2 text-yellow-500"}),"Nível ",s.level||1]}),(0,e.jsxs)("span",{className:"text-sm text-gray-600",children:[a?.nextLevelXP||0," XP para o próximo nível"]})]}),(0,e.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-2",children:(0,e.jsx)("div",{className:"bg-gradient-to-r from-yellow-400 to-yellow-500 h-3 rounded-full transition-all duration-500",style:{width:`${S}%`}})}),(0,e.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,e.jsxs)("span",{children:[a?.currentLevelXP||0," XP"]}),(0,e.jsxs)("span",{children:[a?.maxLevelXP||200," XP"]})]})]}),(0,e.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,e.jsxs)(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"card",children:[(0,e.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,e.jsx)(X,{className:"w-6 h-6 mr-2 text-yellow-500"}),"Seu Ranking"]}),(0,e.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,e.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,e.jsx)("span",{className:"text-gray-600",children:"Posição Global"}),(0,e.jsxs)("span",{className:"font-bold text-primary-600",children:["#",r?.globalPosition||"--"]})]}),s.university&&(0,e.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,e.jsxs)("span",{className:"text-gray-600",children:["Posição na ",s.university]}),(0,e.jsxs)("span",{className:"font-bold text-secondary-600",children:["#",r?.universityPosition||"--"]})]})]}),(0,e.jsxs)("div",{className:"border-t pt-4",children:[(0,e.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Top 5 Global"}),(0,e.jsx)("div",{className:"space-y-2",children:x.slice(0,3).map((i,l)=>(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsx)("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold mr-3 ${l===0?"bg-yellow-500 text-white":l===1?"bg-gray-400 text-white":"bg-orange-400 text-white"}`,children:l+1}),(0,e.jsx)("span",{className:"text-sm",children:i.name})]}),(0,e.jsxs)("span",{className:"text-xs text-gray-500",children:[i.statistics.averageScore.toFixed(1),"%"]})]},i._id))}),(0,e.jsx)(d,{to:"/ranking",className:"block mt-4 text-center text-primary-600 hover:text-primary-700 text-sm font-medium",children:"Ver ranking completo →"})]})]}),(0,e.jsxs)(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},className:"card",children:[(0,e.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,e.jsx)(E,{className:"w-6 h-6 mr-2 text-green-500"}),"Ações Rápidas"]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsxs)(d,{to:"/simulations",className:"flex items-center p-4 bg-primary-50 hover:bg-primary-100 rounded-lg transition-colors group",children:[(0,e.jsx)($,{className:"w-8 h-8 text-primary-600 mr-3 group-hover:scale-110 transition-transform"}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"font-medium text-primary-900",children:"Fazer Simulado"}),(0,e.jsx)("p",{className:"text-sm text-primary-600",children:"Continue seus estudos"})]})]}),(0,e.jsxs)(d,{to:"/simulations/create",className:"flex items-center p-4 bg-secondary-50 hover:bg-secondary-100 rounded-lg transition-colors group",children:[(0,e.jsx)(T,{className:"w-8 h-8 text-secondary-600 mr-3 group-hover:scale-110 transition-transform"}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"font-medium text-secondary-900",children:"Criar Simulado"}),(0,e.jsx)("p",{className:"text-sm text-secondary-600",children:"Personalizado para você"})]})]}),(0,e.jsxs)(d,{to:"/ranking",className:"flex items-center p-4 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition-colors group",children:[(0,e.jsx)(I,{className:"w-8 h-8 text-yellow-600 mr-3 group-hover:scale-110 transition-transform"}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"font-medium text-yellow-900",children:"Ver Ranking"}),(0,e.jsx)("p",{className:"text-sm text-yellow-600",children:"Compare seu progresso"})]})]})]}),(0,e.jsxs)("div",{className:"mt-6 p-4 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-lg text-white",children:[(0,e.jsx)("h3",{className:"font-medium mb-2",children:"💡 Dica do Dia"}),(0,e.jsx)("p",{className:"text-sm opacity-90",children:"Faça simulados regulares para manter seu progresso constante. Consistência é a chave para o sucesso!"})]})]})]}),(0,e.jsxs)(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},className:"card",children:[(0,e.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,e.jsx)(j,{className:"w-6 h-6 mr-2 text-blue-500"}),"Meta da Semana"]}),(0,e.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,e.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,e.jsxs)("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:[a?.totalSimulations||0,"/5"]}),(0,e.jsx)("div",{className:"text-sm text-blue-700",children:"Simulados"}),(0,e.jsx)("div",{className:"w-full bg-blue-200 rounded-full h-2 mt-2",children:(0,e.jsx)("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${Math.min((a?.totalSimulations||0)/5*100,100)}%`}})})]}),(0,e.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,e.jsxs)("div",{className:"text-2xl font-bold text-green-600 mb-1",children:[a?.streakDays||0,"/7"]}),(0,e.jsx)("div",{className:"text-sm text-green-700",children:"Dias Seguidos"}),(0,e.jsx)("div",{className:"w-full bg-green-200 rounded-full h-2 mt-2",children:(0,e.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${Math.min((a?.streakDays||0)/7*100,100)}%`}})})]}),(0,e.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,e.jsxs)("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:[p(a?.timeSpent||0),"/180min"]}),(0,e.jsx)("div",{className:"text-sm text-purple-700",children:"Tempo de Estudo"}),(0,e.jsx)("div",{className:"w-full bg-purple-200 rounded-full h-2 mt-2",children:(0,e.jsx)("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:`${Math.min((a?.timeSpent||0)/180*100,100)}%`}})})]})]})]})]})}export{V as default};
