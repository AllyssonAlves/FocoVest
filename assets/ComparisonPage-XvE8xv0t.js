import{a as y}from"./rolldown-runtime-Dq6TatWD.js";import{D as j,F as h,H as b,K as f,Pt as N,Tt as v,U as w,f as u,o as g,t as p,w as C,x as k}from"./react-vendor-BpwrftXY.js";import{n as l}from"./vendor-DgHb_Dai.js";var x=y(N());function _(){const[a,t]=(0,x.useState)(null),[d,o]=(0,x.useState)(!0),[m,c]=(0,x.useState)(null),i=()=>({Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}),s=(0,x.useCallback)(async()=>{try{if(o(!0),c(null),!localStorage.getItem("token")){c("Token de autenticação não encontrado");return}const n=await(await fetch("/api/users/comparison",{headers:i()})).json();n.success?t(n.data):c(n.message||"Erro ao carregar dados de comparação")}catch(n){c("Erro ao conectar com o servidor"),console.error("Erro ao buscar comparação:",n)}finally{o(!1)}},[]),r=(0,x.useCallback)(async()=>{try{const n=await(await fetch("/api/users/comparison-cache",{method:"DELETE",headers:i()})).json();n.success?await s():console.warn("Erro ao limpar cache:",n.message)}catch(n){console.error("Erro ao limpar cache:",n)}},[s]);return(0,x.useEffect)(()=>{s()},[s]),{data:a,loading:d,error:m,refetch:s,clearCache:r}}var e=y(v());function P({percentile:a,label:t,value:d,className:o="",showTooltip:m=!0}){const c=r=>r>=90?"from-green-500 to-emerald-500":r>=75?"from-blue-500 to-cyan-500":r>=50?"from-yellow-500 to-amber-500":r>=25?"from-orange-500 to-red-500":"from-red-500 to-pink-500",i=r=>r>=90?"text-green-700":r>=75?"text-blue-700":r>=50?"text-yellow-700":r>=25?"text-orange-700":"text-red-700",s=r=>r>=90?"Excelente":r>=75?"Acima da Média":r>=50?"Média":r>=25?"Abaixo da Média":"Precisa Melhorar";return(0,e.jsxs)("div",{className:`relative ${o}`,children:[(0,e.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[t&&(0,e.jsx)("span",{className:"text-sm font-medium text-gray-700",children:t}),(0,e.jsxs)("div",{className:"flex items-center space-x-2",children:[d!==void 0&&(0,e.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:d}),(0,e.jsxs)("span",{className:`text-sm font-bold ${i(a)}`,children:[a.toFixed(1),"%"]})]})]}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"w-full h-3 bg-gray-200 rounded-full overflow-hidden",children:(0,e.jsx)("div",{className:`h-full bg-gradient-to-r ${c(a)} transition-all duration-500 ease-out`,style:{width:`${Math.min(a,100)}%`}})}),(0,e.jsx)("div",{className:"absolute top-0 w-1 h-3 bg-white border-2 border-gray-600 rounded-sm shadow-sm",style:{left:`calc(${Math.min(a,100)}% - 2px)`}})]}),(0,e.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,e.jsx)("span",{className:`text-xs font-medium ${i(a)}`,children:s(a)}),m&&(0,e.jsxs)("span",{className:"text-xs text-gray-500",children:["Melhor que ",(100-a).toFixed(0),"% dos usuários"]})]}),(0,e.jsxs)("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[(0,e.jsx)("span",{children:"0%"}),(0,e.jsx)("span",{children:"25%"}),(0,e.jsx)("span",{children:"50%"}),(0,e.jsx)("span",{children:"75%"}),(0,e.jsx)("span",{children:"100%"})]})]})}function I({insight:a,index:t,className:d=""}){const o=i=>({"🏆":(0,e.jsx)(p,{className:"w-6 h-6 text-yellow-500"}),"📈":(0,e.jsx)(b,{className:"w-6 h-6 text-green-500"}),"💪":(0,e.jsx)(u,{className:"w-6 h-6 text-blue-500"}),"🎓":(0,e.jsx)(f,{className:"w-6 h-6 text-purple-500"}),"🎯":(0,e.jsx)(u,{className:"w-6 h-6 text-red-500"}),"🔥":(0,e.jsx)(C,{className:"w-6 h-6 text-orange-500"})})[i]||(0,e.jsx)(u,{className:"w-6 h-6 text-gray-500"}),m=i=>{switch(i){case"achievement":return"border-yellow-500 bg-yellow-50";case"improvement":return"border-blue-500 bg-blue-50";case"encouragement":return"border-green-500 bg-green-50";case"goal":return"border-purple-500 bg-purple-50";default:return"border-gray-500 bg-gray-50"}},c=i=>{switch(i){case"achievement":return"Conquista";case"improvement":return"Melhoria";case"encouragement":return"Motivação";case"goal":return"Meta";default:return"Insight"}};return(0,e.jsx)(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.1},className:`${m(a.type)} rounded-lg shadow-sm border-l-4 p-4 hover:shadow-md transition-shadow ${d}`,children:(0,e.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,e.jsx)("div",{className:"flex-shrink-0 mt-1",children:o(a.icon)}),(0,e.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,e.jsx)("h3",{className:"font-semibold text-gray-900 text-sm",children:a.title}),(0,e.jsx)("span",{className:"text-xs font-medium text-gray-500 bg-white px-2 py-1 rounded-full",children:c(a.type)})]}),(0,e.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:a.description}),a.value&&(0,e.jsxs)("div",{className:"mt-3 flex items-center space-x-2",children:[a.metric&&(0,e.jsxs)("span",{className:"text-xs text-gray-500",children:[a.metric,":"]}),(0,e.jsx)("div",{className:"text-lg font-bold text-blue-600",children:typeof a.value=="number"?a.value.toFixed(1):a.value})]})]})]})})}function M({className:a=""}){const{data:t,loading:d,error:o,refetch:m}=_(),c=s=>{switch(s){case"excellent":return"text-green-600 bg-green-50";case"above_average":return"text-blue-600 bg-blue-50";case"average":return"text-yellow-600 bg-yellow-50";case"below_average":return"text-orange-600 bg-orange-50";case"needs_improvement":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}},i=s=>{switch(s){case"excellent":return(0,e.jsx)(p,{className:"w-5 h-5 text-green-600"});case"above_average":return(0,e.jsx)(b,{className:"w-5 h-5 text-blue-600"});case"average":return(0,e.jsx)(h,{className:"w-5 h-5 text-yellow-600"});case"below_average":return(0,e.jsx)(w,{className:"w-5 h-5 text-orange-600"});case"needs_improvement":return(0,e.jsx)(j,{className:"w-5 h-5 text-red-600"});default:return(0,e.jsx)(h,{className:"w-5 h-5 text-gray-600"})}};return d?(0,e.jsx)("div",{className:`animate-pulse ${a}`,children:(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsx)("div",{className:"h-32 bg-gray-200 rounded-lg"}),(0,e.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[1,2,3,4].map(s=>(0,e.jsx)("div",{className:"h-24 bg-gray-200 rounded-lg"},s))})]})}):o?(0,e.jsxs)("div",{className:`text-center py-12 ${a}`,children:[(0,e.jsx)(j,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,e.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Erro ao Carregar Comparação"}),(0,e.jsx)("p",{className:"text-gray-600 mb-4",children:o}),(0,e.jsx)("button",{onClick:m,className:"btn-primary",children:"Tentar Novamente"})]}):t?(0,e.jsxs)("div",{className:`space-y-6 ${a}`,children:[(0,e.jsxs)(l.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg p-6 text-white",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Sua Posição no Ranking"}),(0,e.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsxs)("div",{className:"text-3xl font-bold",children:["#",t.rankingPositions.globalPosition]}),(0,e.jsxs)("div",{className:"text-sm opacity-90",children:["de ",t.rankingPositions.totalUsers," usuários"]})]}),(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsxs)("div",{className:"text-3xl font-bold",children:[t.rankingPositions.globalPercentile.toFixed(1),"%"]}),(0,e.jsx)("div",{className:"text-sm opacity-90",children:"percentil"})]})]})]}),(0,e.jsx)(p,{className:"w-16 h-16 text-yellow-300"})]}),t.rankingPositions.universityPosition&&(0,e.jsx)("div",{className:"mt-4 pt-4 border-t border-white/20",children:(0,e.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,e.jsx)("span",{children:"Na sua universidade:"}),(0,e.jsxs)("span",{className:"font-semibold",children:["#",t.rankingPositions.universityPosition," de ",t.rankingPositions.totalUniversityUsers,"(",t.rankingPositions.universityPercentile?.toFixed(1),"%)"]})]})})]}),(0,e.jsx)(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.insights.slice(0,3).map((s,r)=>(0,e.jsx)(I,{insight:s,index:r},r))}),(0,e.jsxs)(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-lg shadow",children:[(0,e.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,e.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,e.jsx)(h,{className:"w-5 h-5 mr-2"}),"Comparação Detalhada de Métricas"]})}),(0,e.jsx)("div",{className:"p-6",children:(0,e.jsx)("div",{className:"space-y-4",children:t.metricComparisons.map((s,r)=>(0,e.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,e.jsxs)("div",{className:"flex items-center space-x-2",children:[i(s.category),(0,e.jsx)("span",{className:"font-medium text-gray-900",children:s.metric})]}),(0,e.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${c(s.category)}`,children:s.category.replace("_"," ")})]}),(0,e.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"text-gray-500",children:"Seu Valor"}),(0,e.jsx)("div",{className:"font-semibold text-blue-600",children:s.userValue})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"text-gray-500",children:"Média"}),(0,e.jsx)("div",{className:"font-medium",children:s.average})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"text-gray-500",children:"Percentil"}),(0,e.jsxs)("div",{className:"font-semibold text-green-600",children:[s.percentile.toFixed(1),"%"]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"text-gray-500",children:"Melhor que"}),(0,e.jsxs)("div",{className:"font-semibold text-purple-600",children:[s.betterThanPercent.toFixed(1),"%"]})]})]}),(0,e.jsx)("div",{className:"mt-3",children:(0,e.jsx)(P,{percentile:s.percentile,label:`Percentil: ${s.percentile.toFixed(1)}%`,value:s.userValue,showTooltip:!0})})]},r))})})]}),(0,e.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.goals.length>0&&(0,e.jsxs)(l.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},className:"bg-white rounded-lg shadow",children:[(0,e.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,e.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,e.jsx)(u,{className:"w-5 h-5 mr-2"}),"Suas Próximas Metas"]})}),(0,e.jsx)("div",{className:"p-6",children:(0,e.jsx)("div",{className:"space-y-4",children:t.goals.map((s,r)=>(0,e.jsxs)("div",{className:"border-l-4 border-green-500 pl-4",children:[(0,e.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,e.jsx)("h4",{className:"font-medium text-gray-900",children:s.metric}),(0,e.jsx)("span",{className:"text-sm text-gray-500",children:s.timeEstimate})]}),(0,e.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,e.jsxs)("span",{children:["Atual: ",(0,e.jsx)("span",{className:"font-semibold",children:s.current})]}),(0,e.jsxs)("span",{children:["Meta: ",(0,e.jsx)("span",{className:"font-semibold text-green-600",children:s.target})]})]}),(0,e.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,e.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${s.current/s.target*100}%`}})}),(0,e.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Percentil alvo: ",s.percentileTarget,"%"]})]},r))})})]}),t.similarUsers.length>0&&(0,e.jsxs)(l.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.4},className:"bg-white rounded-lg shadow",children:[(0,e.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,e.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,e.jsx)(g,{className:"w-5 h-5 mr-2"}),"Usuários Similares"]})}),(0,e.jsx)("div",{className:"p-6",children:(0,e.jsx)("div",{className:"space-y-3",children:t.similarUsers.map((s,r)=>(0,e.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"font-medium text-gray-900",children:s.name}),s.university&&(0,e.jsx)("div",{className:"text-sm text-gray-500",children:s.university})]}),(0,e.jsxs)("div",{className:"text-right",children:[(0,e.jsxs)("div",{className:"text-sm font-medium text-blue-600",children:[s.similarity.toFixed(1),"% similar"]}),(0,e.jsx)("div",{className:`text-xs ${s.performance==="better"?"text-green-600":s.performance==="similar"?"text-blue-600":"text-orange-600"}`,children:s.performance==="better"?"Melhor":s.performance==="similar"?"Similar":"Atrás"})]})]},r))})})]})]}),(0,e.jsxs)("div",{className:"text-center text-sm text-gray-500",children:["Dados atualizados em: ",new Date(t.calculatedAt).toLocaleString("pt-BR")]})]}):(0,e.jsxs)("div",{className:`text-center py-12 ${a}`,children:[(0,e.jsx)(g,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,e.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Dados Insuficientes"}),(0,e.jsx)("p",{className:"text-gray-600",children:"Complete alguns simulados para ver sua comparação com outros usuários"})]})}function U(){const[a,t]=(0,x.useState)("full");return(0,e.jsx)(l.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen bg-gray-50 py-8",children:(0,e.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,e.jsxs)("div",{className:"mb-8",children:[(0,e.jsxs)(l.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center",children:[(0,e.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Comparação com Outros Usuários"}),(0,e.jsx)("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:"Veja como seu desempenho se compara com outros estudantes da plataforma. Descubra seus pontos fortes, áreas de melhoria e metas personalizadas."})]}),(0,e.jsxs)(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-8",children:[(0,e.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,e.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,e.jsx)(g,{className:"w-8 h-8 text-blue-600"}),(0,e.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Rankings"})]}),(0,e.jsx)("p",{className:"text-gray-600 text-sm",children:"Veja sua posição no ranking geral e da sua universidade"})]}),(0,e.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,e.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,e.jsx)(h,{className:"w-8 h-8 text-green-600"}),(0,e.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Métricas"})]}),(0,e.jsx)("p",{className:"text-gray-600 text-sm",children:"Compare suas métricas com a média dos outros usuários"})]}),(0,e.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,e.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,e.jsx)(f,{className:"w-8 h-8 text-purple-600"}),(0,e.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Insights"})]}),(0,e.jsx)("p",{className:"text-gray-600 text-sm",children:"Receba insights personalizados e metas de melhoria"})]})]})]}),(0,e.jsx)(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-8",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Visualização"}),(0,e.jsxs)("div",{className:"flex space-x-2",children:[(0,e.jsx)("button",{onClick:()=>t("full"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${a==="full"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Comparação Completa"}),(0,e.jsx)("button",{onClick:()=>t("ranking"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${a==="ranking"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Apenas Rankings"}),(0,e.jsx)("button",{onClick:()=>t("metrics"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${a==="metrics"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Métricas Detalhadas"})]})]})}),(0,e.jsx)(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8",children:(0,e.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,e.jsx)(k,{className:"w-6 h-6 text-blue-600 mt-0.5 flex-shrink-0"}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"text-sm font-semibold text-blue-900 mb-1",children:"Como interpretar os dados"}),(0,e.jsx)("p",{className:"text-sm text-blue-800",children:"Os percentis mostram sua posição relativa: se você está no percentil 75%, significa que está melhor que 75% dos usuários. Rankings são atualizados em tempo real e consideram apenas usuários ativos nos últimos 30 dias."})]})]})}),(0,e.jsx)(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:(0,e.jsx)(M,{})}),(0,e.jsx)(l.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-12 text-center text-gray-500 text-sm",children:(0,e.jsx)("p",{children:"Os dados são atualizados automaticamente a cada hora. Para uma comparação mais precisa, certifique-se de ter completado pelo menos 10 simulados."})})]})})}export{U as default};
